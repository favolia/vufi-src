const axios = require("axios");

module.exports = chatGPT = async (text) => {
  try {
    const { data } = await axios(
      `https://chat.chatgptdemo.net/chat_api_stream`,
      {
        method: "post",
        data: { question: text },
      }
    );
    let clr = data.split('content":"');
    let resu = clr.map((rs) => rs.split('"},"index"')[0].split('delta":{"')[0]);
    let twt = resu.map((s) => s.split('"},"finish_reason"')[0]);
    let stringText = twt.map((s) => s.split('index":0,'));
    stringText.splice(0, 2);
    const result = stringText.join("").replace(/\\n/g, "\n").replace(/\\/g, "");
    console.log(result);
    return result;
  } catch {
    const result = {
      status: false,
      message: "Unknown error",
    };
    console.log(result);
    return result;
  }
};
